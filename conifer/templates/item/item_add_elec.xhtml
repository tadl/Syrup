<?python
is_edit = bool(item.id)
title = is_edit and _('Edit an electronic document') or _('Add a new electronic document')
course_title = '%s: %s (%s)' % (course.code, course.title, course.term)
?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:py="http://genshi.edgewall.org/">
  <xi:include href="../master.xhtml"/>
  <xi:include href="../components/course.xhtml"/>
  <head>
    <title>${title}</title>
    <script type="text/javascript">
      $(function() {$('input[name="title"]').focus();});
    </script>
    ${item_metadata_formset_header()}
  </head>
  <body>
    ${course_banner(course)}
    ${nested_title(parent_item)}
    ${offer_to_delete(item)}
    <h2>${title}</h2>
    <div py:if="not is_edit">
      <form action=".?item_type=${item_type}" method="POST"
	    enctype="multipart/form-data">
	<table class="metadata_table">
	  <tr><th>Title of document</th><td><input type="text" 
	  name="title"
	  value="${item.title}"/></td></tr>
	  <tr><th>File</th><td><input type="file" name="file"/></td></tr>
	</table>
	${item_metadata_formset()}
	<p><input type="submit" value="Upload file and Create item"/>
	${go_back_link()}
	</p>
      </form>
    </div>

    <div py:if="is_edit">
      <form action="." method="POST">
	<table class="metadata_table">
	  <tr><th>Title of document</th><td><input type="text" name="title"
	  value="${item.title}"/></td></tr>
	</table>
	${item_metadata_formset()}
	<p><input type="submit" value="Update title and metadata"/></p>
      </form>
      <h2>File contents</h2>
      <form action="." method="POST" enctype="multipart/form-data">
	<table class="metadata_table">
	  <tr><th>File</th><td><input type="file" name="file"/></td></tr>
	</table>
	<p><input type="submit" value="Upload new file contents"/></p>
      </form>
    </div>
</body>
</html>
